@{
	ViewData["Title"] = "Manage User role";
}

@model RoleManagementVM
@{
	string ToggleVisible = Model.ApplicationUser.Role != SD.Role_Company ? "hidden" : "";
}
<div class="container mx-auto p-4">
	<div class="flex justify-between items-center pb-4">
		<h2 class="text-2xl font-bold text-indigo-600">@ViewData["Title"]</h2>
	</div>
</div>

<form method="post" class="space-y-4">
	<input type="hidden" asp-for="@Model.ApplicationUser.Id" />

	<div class="bg-white rounded-md p-6 space-y-6 border border-slate-200">
		<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
			<div>
				<label asp-for="ApplicationUser.Name" class="block text-gray-700 font-medium"></label>
				<input asp-for="ApplicationUser.Name" disabled type="text" class="w-full bg-slate-200 pointer-events-none placeholder:text-slate-400 text-slate-700 text-md border border-slate-200 rounded-md px-3 py-2.5 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-300 shadow-sm focus:shadow" />
			</div>

			<div>
				<div class="w-full min-w-[200px]">
					<label class="block mb-1 text-sm text-slate-800">
						Roles
					</label>
					<div class="relative">
						<select asp-for="ApplicationUser.Role" asp-items="@Model.RoleList" id="selectRole" onchange="RoleSelectedChanged(event)"
								class="w-full bg-transparent placeholder:text-slate-400 text-slate-700 text-sm border border-slate-200
						rounded-md pl-3 pr-8 py-3 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-400 shadow-sm focus:shadow-md appearance-none cursor-pointer">
							<button>
								<selectedcontent></selectedcontent>
							</button>
						</select>
						<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor" class="h-5 w-5 ml-1 absolute top-3.5 right-2.5 text-slate-700">
							<path stroke-linecap="round" stroke-linejoin="round" d="M8.25 15 12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
						</svg>
					</div>
				</div>
			</div>


			<div>
				<div class="w-full min-w-[200px] main @ToggleVisible">
					<label class="block mb-1 text-sm text-slate-800">
						Companies
					</label>
					<div class="relative">
						<select id="companySelection" asp-for="ApplicationUser.CompanyID" asp-items="@Model.CompanyList" class="@ToggleVisible w-full bg-transparent placeholder:text-slate-400 text-slate-700 text-sm border border-slate-200
						rounded-md pl-3 pr-8 py-3 transition duration-300 ease focus:outline-none focus:border-slate-400 hover:border-slate-400 shadow-sm focus:shadow-md appearance-none cursor-pointer">
						</select>
						<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.2" stroke="currentColor" class="h-5 w-5 ml-1 absolute top-3.5 right-2.5 text-slate-700">
							<path stroke-linecap="round" stroke-linejoin="round" d="M8.25 15 12 18.75 15.75 15m-7.5-6L12 5.25 15.75 9" />
						</svg>
					</div>
				</div>
			</div>

		</div>

		<div class="flex items-center justify-between mt-4">
			<a asp-action="Index" class="text-gray-600 hover:text-indigo-500 font-medium flex items-center">
				<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 mr-1">
					<path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
				</svg>
				Back to List
			</a>

			<div class="ml-auto flex space-x-2">
				<button type="submit" class="btn-indigo">Update Role</button>
			</div>
		</div>

	</div>
</form>


<script>
	// document.addEventListener('DOMContentLoaded', function () {
	// 	const RoleDropdown = document.getElementById('selectRole');
	// 	const CompanyDropdown = document.getElementById('companySelection');
	// 	RoleDropdown.addEventListener('change', function () {
	// 		CompanyDropdown.classList.toggle('hidden', this.value !== 'Company');
	// 	});
	// });


	const RoleSelectedChanged = function(e){
		let currentRole = e.currentTarget.value;
		const CompanyDropdown = document.getElementById('companySelection');
		CompanyDropdown.closest('.main')?.classList.toggle('hidden', currentRole !== 'Company');
		CompanyDropdown.classList.toggle('hidden', currentRole !== 'Company');
	}

</script>


@section Scripts {
	@{
		<partial name="_ValidationScriptsPartial"></partial>
	}
}