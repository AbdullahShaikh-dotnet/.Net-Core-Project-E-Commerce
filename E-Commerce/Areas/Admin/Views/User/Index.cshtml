@section Styles {
    <link href="//cdn.datatables.net/v/bs5/jszip-3.10.1/dt-2.1.8/af-2.7.0/b-3.2.0/b-colvis-3.2.0/b-html5-3.2.0/b-print-3.2.0/cr-2.0.4/date-1.5.4/fc-5.0.4/fh-4.0.1/kt-2.12.1/r-3.0.3/rg-1.5.1/rr-1.5.0/sc-2.4.3/sb-1.8.1/sp-2.3.3/sl-2.1.0/sr-1.4.1/datatables.min.css" rel="stylesheet">
    <link href="~/css/datatables.tailwind.css" rel="stylesheet" />
}

@{
    ViewData["Title"] = "User List";
}


<div class="mx-auto mt-4 mb-5 flex flex-col md:flex-row md:justify-between gap-4 mb-4">

    <div>
        <h2 class="text-indigo-700 text-2xl md:text-3xl font-bold">@ViewData["Title"]</h2>
    </div>
</div>

<div class="main flex w-[500px] justify-end flex-row items-center gap-2 rounded-md border border-slate-300 bg-white mb-2 p-1">
    <div class="relative grid h-full w-full min-w-[200px]">
        <textarea rows="1" placeholder="Send Notification"
                  class="peer h-full  min-h-full w-full resize-y rounded-[7px] !border-0 border-blue-gray-200 border-t-transparent bg-transparent px-3 py-2.5 font-sans text-sm font-normal text-blue-gray-700 outline outline-0 transition-all placeholder:text-blue-gray-300 placeholder-shown:border placeholder-shown:border-blue-gray-200 placeholder-shown:border-t-blue-gray-200 focus:border-2 focus:border-gray-900 focus:border-transparent focus:border-t-transparent focus:outline-0 disabled:resize-none disabled:border-0 disabled:bg-blue-gray-50"></textarea>
        <label class="before:content[' '] after:content[' '] pointer-events-none absolute left-0 -top-1.5 flex h-full w-full select-none text-[11px] font-normal leading-tight text-blue-gray-400 transition-all before:pointer-events-none before:mt-[6.5px] before:mr-1 before:box-border before:block before:h-1.5 before:w-2.5 before:rounded-tl-md before:border-t before:border-l before:border-blue-gray-200 before:transition-all before:content-none after:pointer-events-none after:mt-[6.5px] after:ml-1 after:box-border after:block after:h-1.5 after:w-2.5 after:flex-grow after:rounded-tr-md after:border-t after:border-r after:border-blue-gray-200 after:transition-all after:content-none peer-placeholder-shown:text-sm peer-placeholder-shown:leading-[3.75] peer-placeholder-shown:text-blue-gray-500 peer-placeholder-shown:before:border-transparent peer-placeholder-shown:after:border-transparent peer-focus:text-[11px] peer-focus:leading-tight peer-focus:text-gray-900 peer-focus:before:border-t-2 peer-focus:before:border-l-2 peer-focus:before:!border-gray-900 peer-focus:after:border-t-2 peer-focus:after:border-r-2 peer-focus:after:!border-gray-900 peer-disabled:text-transparent peer-disabled:before:border-transparent peer-disabled:after:border-transparent peer-disabled:peer-placeholder-shown:text-blue-gray-500"></label>
    </div>
    <div>
        <button class="btnNotification relative h-10 max-h-[40px] w-10 max-w-[40px] select-none rounded-md text-center align-middle font-sans text-md font-medium uppercase text-gray-900 transition-all hover:bg-gray-900/10 active:bg-gray-900/20 disabled:pointer-events-none disabled:opacity-50 disabled:shadow-none"
                type="button">
            <span class="absolute transform -translate-x-1/2 -translate-y-1/2 top-1/2 left-1/2">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 12 3.269 3.125A59.769 59.769 0 0 1 21.485 12 59.768 59.768 0 0 1 3.27 20.875L5.999 12Zm0 0h7.5" />
                </svg>
            </span>
        </button>
    </div>
</div>
<p class="flex items-start justify-start mt-2 text-xs text-slate-400 mb-5">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-5 h-5 mr-1.5">
        <path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd" />
    </svg>
    All users receive this broadcast notification.
</p>





<div class="bg-white rounded-lg p-4 border border-slate-200">
    <table class="tblData w-full border-collapse border border-gray-200 rounded-lg"
           data-Root="/admin/user/"
           data-GetURL="getall"
           data-LockUnlockURL="lockunlock"
           data-PermissionURL="RoleManagement?Userid=">
    </table>
</div>

@section Scripts {
    <script src="https://cdn.datatables.net/2.2.2/js/dataTables.js" asp-append-version="true"></script>
    <script src="~/js/datatables.tailwind.js"></script>
    <script src="~/js/User.js"></script>
}


<script>
    const Notifybtns = document.querySelector('.btnNotification');
    Notifybtns.addEventListener('click', async (e) => {
        const NotifyInput = e.currentTarget.closest('main')?.querySelector('textarea');
                const NotifyMessage = NotifyInput?.value;
                if (NotifyMessage) {
                    const response = await fetch(`/Admin/User/Notification`, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json" // Specify JSON format
                        },
                        body: JSON.stringify(NotifyMessage) // Send as an object
                    });

                    if (!response.ok) {
                        console.error("Error:", response.statusText);
                    } else {
                        NotifyInput.value = '';
                    }
                }
    });
</script>